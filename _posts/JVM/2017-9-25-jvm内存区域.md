---
layout: post
title: jvm内存区域
tags: jvm 内存
categories: jvm
---  
[toc]  

### 1、内存总揽    
<img src="https://zy123a.github.io/zy-blog/images/jvm/jvm内存分布区域.png" width="500" height="400" alt="image"/>    

### 2、程序计数器  
**概念：** 程序计数器可看成当前程序执行的字节码的行号指示器，其作用不仅指示着程序下一条需要执行的字节码指令，而且
用于保证线程切换后能够正确恢复到下一条需要执行的指令位置；    
    
**特性：** 哥线程的程序计数器相互独立，互不影响，属于线程私有； 并且其是java中唯一一个没有规范有OutOfMemoryError情况的区域；    

### 3、java虚拟机栈    
**慨念：** 虚拟机栈描述的是java方法执行的内存模型，每个方法在执行的同时会创建一个栈帧用于存储局部变量表，操作数栈，动态链接
方法出口等信息，每个方法的从调用直到执行完成的过程就对应着一个栈帧在虚拟机栈的入栈到出栈的过程。     

**特性：** 虚拟机栈是线程私有的，他的生命周期与线程相同。    

**存储信息：**     
* 局部变量表：存储了各种基本类型(int,long,byte,char,short,boolean,float等)，对象引用(reference类型，可能指向对象的起始地
址或者对象句柄)，returnAdress类型（指向下一条指令），其中long，double类型64位会占用2个局部变量空间(slot),其他只占用一个；    
局部变量表在类编译机器完成分配，当进入一个方法时，局部变量表的大小已经确定，后期将不再更改；       
    
**异常类型：**    
* 当线程请求的栈深度大于虚拟机栈所允许的深度时，抛出StackOverflowError    
* 虚拟机栈扩展或创建时无法申请到足够的内存时，抛出OutOfMemoryError      

### 4、本地方法栈    
本地方法栈和虚拟机栈很相似，虚拟机栈是为虚拟机执行java方法服务的，而本地方法栈是虚拟机执行本地方法服务的，其同样会抛出StackOverflowError，
OutOfMemoryError异常；    

### 5、java堆  
**概念：** 虚拟机启动时创建，用于存放对象实例及数组，其主要是垃圾收集器的主要区域，因此也称为"GC堆"   
**存储：** 对象实例以及数组    
**特性：** 在堆中没有内存完成实例分配时，抛出OutOfMemoryError异常，物理内存不需要连续，逻辑上连续即可；   

### 6、方法区
**概念：** 各个线程共享的内存区域；   
**存储：** 已被虚拟机加载的类信息，常量，静态变量，即时编译器编译后的代码等数据；    
**特性：** 方法区里的垃圾回收的目标主要针对常量池的回收和对类型的卸载；其中类型的卸载条件非常的苛刻，当方法区无法满足内存分配需求时，抛出抛出OutOfMemoryError异常   

### 7、运行时常量池    
**概念：** 方法区的一部分   
**存储：** 存放编译期生成的各种字面量（文本，final变量），符号引用（类，方法，变量的名称和描述）    
**特性：** 具备动态性，常量并非编译期产生，运行期间也可产生，例如String.intern方法，当常量池无法申请到内存时会抛出OutOfMemoryError异常   

### 8、直接内存   
**概念：** 不是虚拟机运行时的数据区域，属于虚拟机外的内存；
